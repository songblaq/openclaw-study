# 크론잡

## 개요
게이트웨이의 내장 스케줄러로 예약 작업 실행.
- 게이트웨이 프로세스 내부에서 실행
- `~/.openclaw/cron/jobs.json`에 작업 저장
- 재시작해도 유지됨

## 두 가지 실행 스타일

### 1. 메인 세션 (`sessionTarget: "main"`)
- 시스템 이벤트 큐에 추가
- 다음 하트비트에서 전체 컨텍스트와 함께 실행
- 페이로드: `kind: "systemEvent"`

### 2. 격리 세션 (`sessionTarget: "isolated"`)
- 새 세션 `cron:<jobId>`
- 이전 대화 컨텍스트 없음
- 메인 세션에 요약 게시
- 페이로드: `kind: "agentTurn"`

## 스케줄 유형

| 유형 | CLI 플래그 | 설명 |
|------|-----------|------|
| `at` | `--at` | 일회성 타임스탬프 |
| `every` | `--every` | 고정 간격 |
| `cron` | `--cron` | 5자리 크론 표현식 |

## 빠른 시작

### 일회성 알림
```bash
openclaw cron add \
  --name "알림" \
  --at "2026-02-01T16:00:00Z" \
  --session main \
  --system-event "알림: 문서 확인하기" \
  --wake now \
  --delete-after-run
```

### 반복 작업 + 전달
```bash
openclaw cron add \
  --name "아침 브리핑" \
  --cron "0 7 * * *" \
  --tz "Asia/Seoul" \
  --session isolated \
  --message "밤새 업데이트 요약해줘." \
  --deliver \
  --channel whatsapp \
  --to "+821012345678"
```

### 모델 오버라이드
```bash
openclaw cron add \
  --name "심층 분석" \
  --cron "0 6 * * 1" \
  --session isolated \
  --message "주간 분석" \
  --model "opus" \
  --thinking high \
  --deliver
```

## CLI 명령어

```bash
# 작업 목록
openclaw cron list

# 즉시 실행
openclaw cron run <jobId> --force

# 실행 기록 보기
openclaw cron runs --id <jobId>

# 작업 편집
openclaw cron edit <jobId> --message "새 프롬프트"

# 작업 삭제
openclaw cron remove <jobId>
```

## 설정

```json5
{
  cron: {
    enabled: true,
    store: "~/.openclaw/cron/jobs.json",
    maxConcurrentRuns: 1
  }
}
```

비활성화: `cron.enabled: false` 또는 `OPENCLAW_SKIP_CRON=1`

## JSON 스키마 (도구 호출)

### 일회성 (메인)
```json
{
  "name": "알림",
  "schedule": { "kind": "at", "atMs": 1738262400000 },
  "sessionTarget": "main",
  "wakeMode": "now",
  "payload": { "kind": "systemEvent", "text": "알림 텍스트" },
  "deleteAfterRun": true
}
```

### 반복 (격리)
```json
{
  "name": "아침 브리핑",
  "schedule": { "kind": "cron", "expr": "0 7 * * *", "tz": "Asia/Seoul" },
  "sessionTarget": "isolated",
  "payload": {
    "kind": "agentTurn",
    "message": "업데이트 요약해줘.",
    "deliver": true,
    "channel": "whatsapp",
    "to": "+821012345678"
  }
}
```

## 전달 대상
- WhatsApp: `+821012345678`
- Discord: `channel:<id>` 또는 `user:<id>`
- Slack: `channel:<id>` 또는 `user:<id>`
- Telegram: `-1001234567890` 또는 `-1001234567890:topic:123`
