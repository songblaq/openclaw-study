# 크론 vs 하트비트

## 빠른 결정

| 사용 사례 | 권장 |
|----------|------|
| 30분마다 받은편지함 확인 | 하트비트 |
| 매일 오전 9시 정각 보고서 | 크론 (격리) |
| 캘린더 모니터링 | 하트비트 |
| 주간 심층 분석 | 크론 (격리) |
| 20분 후 알림 | 크론 (`--at`) |
| 프로젝트 상태 점검 | 하트비트 |

## 하트비트: 주기적 인식

**메인 세션**에서 일정 간격으로 실행 (기본: 30분).

### 사용 시기
- 여러 주기적 체크 (받은편지함 + 캘린더 + 날씨 일괄 처리)
- 대화 컨텍스트 필요
- 타이밍이 약간 달라도 됨
- API 호출 줄이기

### 장점
- 여러 체크를 한 턴에 일괄 처리
- 컨텍스트 인식 결정
- 스마트 억제 (`HEARTBEAT_OK`)
- 낮은 오버헤드

### 예시: HEARTBEAT.md
```markdown
# 하트비트 체크리스트
- 긴급 이메일 확인
- 2시간 내 캘린더 이벤트 검토
- 백그라운드 작업 완료 시 요약
```

### 설정
```json5
{
  agents: {
    defaults: {
      heartbeat: {
        every: "30m",
        target: "last",
        activeHours: { start: "08:00", end: "22:00" }
      }
    }
  }
}
```

## 크론: 정확한 스케줄링

**정확한 시간**에 격리 또는 메인 세션에서 실행.

### 사용 시기
- 정확한 타이밍 필요
- 독립 작업 (컨텍스트 불필요)
- 다른 모델/사고 설정
- 일회성 알림
- 메인 히스토리를 어지럽힐 작업

### 장점
- 정확한 타이밍 (크론 표현식 + 시간대)
- 세션 격리
- 모델 오버라이드
- 전달 제어

### 예시
```bash
openclaw cron add \
  --name "아침 브리핑" \
  --cron "0 7 * * *" \
  --tz "Asia/Seoul" \
  --session isolated \
  --message "오늘 브리핑" \
  --model opus \
  --deliver
```

## 결정 플로우차트

```
정확한 시간 필요?
  예 → 크론
  아니오 ↓
세션 격리 필요?
  예 → 크론 (격리)
  아니오 ↓
다른 체크와 일괄 처리 가능?
  예 → 하트비트
  아니오 → 크론
```

## 둘 다 사용 (권장)

**하트비트** (30분마다):
- 받은편지함 스캔
- 캘린더 확인
- 대기 작업 검토

**크론** (정확한 타이밍):
- `0 7 * * *` - 아침 브리핑
- `0 9 * * 1` - 주간 리뷰 (월요일)
- 일회성 알림

## 세션 비교

|  | 하트비트 | 크론 (메인) | 크론 (격리) |
|--|---------|-----------|-----------|
| 세션 | 메인 | 메인 (이벤트 경유) | `cron:<jobId>` |
| 히스토리 | 공유 | 공유 | 매 실행마다 새로 |
| 컨텍스트 | 전체 | 전체 | 없음 |
| 모델 | 메인 세션 | 메인 세션 | 오버라이드 가능 |

## 비용 팁
- HEARTBEAT.md 작게 유지
- 비슷한 체크는 하트비트에 일괄 처리
- 루틴 크론 작업에 저렴한 모델 사용
- 내부 처리만 필요하면 `target: "none"` 사용
